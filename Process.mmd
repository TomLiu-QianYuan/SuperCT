graph TB
    subgraph 初始化环节
        direction LR
        导入模块 --> 设置全局变量 --> 初始化会话状态
        初始化会话状态 --> 判断目录列表
        判断目录列表 -- 否 --> 爬取目录 --> 显示目录完成提示
        判断目录列表 -- 是 --> 不进行爬取操作
    end
    subgraph 主程序流程
        主函数 --> 设置页面标题 --> 显示下拉框 --> 用户选择
        用户选择 --> 是否选择
        是否选择 -- 否 --> 主函数
        是否选择 -- 是 --> 清空状态1 --> 加载单词例句
        加载单词例句 --> 获取链接 --> 请求内容 --> 加载单词函数
        加载单词函数 --> 是否成功
        是否成功 -- 否 --> 无法解析提示 --> 可能返回选择环节["用户可能返回重新选择文章"]
        是否成功 -- 是 --> 加载完成提示 --> 准备列表
        准备列表 --> 遍历单词例句 --> 添加到列表
        添加到列表 --> 显示表格提示 --> 创建数据框 --> 显示表格
        显示表格 --> 显示确认按钮 --> 用户确认 --> 调用运行函数
        调用运行函数 --> 清空运行状态2 --> 根据模式准备
        根据模式准备 --> 判断模式
        判断模式 -- 以英文选中文 --> 交换列表
        判断模式 -- 以单词选例句 --> 准备例句相关1 --> 准备例句相关2
        判断模式 -- 以例句选单词 --> 准备例句相关3 --> 准备例句相关4
        交换列表/准备例句相关2/准备例句相关4 --> 开始循环 --> 获取序号 --> 是否完成
        是否完成 -- 否 --> 创建表单 --> 获取原始单词 --> 随机采样
        随机采样 --> 展示信息进度 --> 播放读音
        播放读音 --> 设置选项 --> 用户选择选项 --> 判断答案
        判断答案 -- 是 --> 正确提示
        判断答案 -- 否 --> 错误提示
        正确提示/错误提示 --> 清空提示 --> 判断卡住
        判断卡住 -- 是 --> 增加次数 --> 可能影响进度["可能影响整体测试进度"]
        判断卡住 -- 否 --> 继续循环判断 --> 是否完成
        是否完成 -- 是 --> 批改部分 --> 随机特效
        随机特效 --> 去重列表 --> 显示文章信息 --> 显示正确率
        显示正确率 --> 判断重复点击
        判断重复点击 -- 有 --> 重复提示
        判断重复点击 -- 无 --> 绘制折线图 --> 创建表格
        创建表格 --> 遍历中文列表 --> 判断答案 --> 添加正确行/添加错误行
        添加正确行/添加错误行 --> 完成表格 --> 显示聊天 --> 显示下载
    end
    初始化环节 --> 主程序流程
    可能返回选择环节 --> 显示下拉框
    可能影响进度 --> 是否完成